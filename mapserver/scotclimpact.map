MAP
  NAME "Scotland Climate Change Impact Tool"
  STATUS ON
  SIZE 600 600
  EXTENT -8.6500071815221 54.63323824941572 -0.724609406991657 60.86076643216307
  PROJECTION
    "init=epsg:4326"
  END

  WEB
    IMAGEPATH "/tmp/"
    IMAGEURL "/ms_tmp/"
    METADATA
      "wms_title"          "Scotland Climate Change Impact Tool"
      "wms_abstract"       "map server for "
      "wms_onlineresource" "https://www.geos.ed.ac.uk/maps/ddekler/scotclimpact.map?"
      "wms_srs"            "EPSG:4326 EPSG:4269 EPSG:3978 EPSG:3857"
      "wms_enable_request" "*"
      "wms_getfeatureinfo_formatlist" "text/plain,text/html,application/vnd.ogc.gml,gml,geojson"

      "wfs_title"         "Scotland Climate Change Impact Tool" ##REQUIRED
      "wfs_srs"           "EPSG:4326 EPSG:3857" ## REQUIRED
      "gml_include_items" "all" ## Optional (serves all attributes for layer)
      "gml_featureid"     "ID" ## REQUIRED
      "gml_types"         "auto" ## Optional (automatically populate the type for the attributes)
      "wfs_enable_request" "*"
      "wfs_use_default_extent_for_getfeature" "false" ## Optional (improves performance of OGR layers)
      "wfs_getfeature_formatlist" "geojson"
    END
  END

  OUTPUTFORMAT
    NAME "geojson"
    DRIVER "OGR/GEOJSON"
    MIMETYPE "application/json; subtype=geojson"
    FORMATOPTION "STORAGE=stream"
    FORMATOPTION "FORM=SIMPLE"
    FORMATOPTION "LCO:RFC7946=YES"
  END

  #LAYER
  #  NAME grid1
  #  TYPE raster
  #  STATUS default
  #  #DATA "cru_ts4.07.2021.2022.tmp.dat.nc"
  #  #DATA "MOD11B1.A2008138.h19v12.061.2021101030756.h5"
  #  #DATA 'tmp'
  #  DATA cru_ts4.07.2021.2022.tmp.dat.tif
  #  #PROCESSING "SCALE=0,30"
  #  #PROCESSING "SCALE_BUCKETS=4"
  #  #PROCESSING "VARIABLE=tmp,time=1"
  #  #PROCESSING "VARIABLE=LST_Day_6km"
  #  #PROCESSING "VARIABLE=//MODIS_Grid_Daily_6km_LST/Data_Fields/Day_view_angl"
  #  #OUTPUTFORMAT "geojson"

  #  METADATA
  #    "wfs_featureid"     "grid1" 
  #    "wfs_getfeature_formatlist" "geojson"
  #    #"wfs_getfeature_formatlist" "csv,csvstream,ogrgml,ogrgpx,ogrcsvzip,ogrgmlstream,shapezip,shapezipmem,midmif,multimidmif"
  #    #"gml_include_items" "all"
  #    #"gml_exclude_items" "ROAD_"
  #    #"gml_types"         "auto"
  #  END

  #  #CLASS
  #  #  NAME "blue"
  #  #  EXPRESSION ([pixel] < 10)
  #  #  STYLE
  #  #    COLOR 0 0 255
  #  #  END
  #  #END
  #  #CLASS
  #  #  NAME "green"
  #  #  EXPRESSION ([pixel] >= 10 and [pixel] < 20)
  #  #  STYLE
  #  #    COLOR 0 255 0
  #  #  END
  #  #END
  #  #CLASS
  #  #  NAME "red"
  #  #  EXPRESSION ([pixel] >= 20)
  #  #  STYLE
  #  #    COLOR 255 0 0
  #  #  END
  #  #END
  #END

  LAYER
    NAME grid2
    TYPE POLYGON
    STATUS ON
    CONNECTIONTYPE POSTGIS
    CONNECTION "host=postgis user=scotclimpact dbname=scotclimpact password=testingtesting"
    DATA "geometry from (select id as gss_id, st_setsrid(geom, 4326) as geometry, param_a as param_a from model_parameters) as subquery using unique gss_id using srid=4326"

    CLASS
      NAME grid2
      GROUP value
      STYLE
        SYMBOL "cicle"
        COLOR 255 255 255
      END
    END

    PROJECTION
      "init=epsg:4326"
    END

    METADATA
      "wfs_featureid"     "grid2" 
      "wfs_getfeature_formatlist" "geojson"
      "wfs_srs"           "EPSG:4326 EPSG:3857" ## REQUIRED
      "gml_include_items" "param_a"
      #"gml_exclude_items" "ROAD_"
      #"gml_types"         "auto"
    END
  END
END
